if (NOT DEFINED CHIBIOS_LOCATION)
    message(FATAL_ERROR "CHIBIOS_LOCATION not defined")
endif (NOT DEFINED CHIBIOS_LOCATION)

if (NOT DEFINED CHIBIOS_CONFIG_LOCATION)
    message(FATAL_ERROR "CHIBIOS_CONFIG_LOCATION not defined")
endif (NOT DEFINED CHIBIOS_CONFIG_LOCATION)

if (NOT DEFINED CHIBIOS_PLATFORM_INCLUDES)
	message(FATAL_ERROR "CHIBIOS_PLATFORM_INCLUDES not defined")
endif (NOT DEFINED CHIBIOS_PLATFORM_INCLUDES)

set (OS_INCLUDES
	${CHIBIOS_LOCATION}/os/hal/include
	${CHIBIOS_LOCATION}/os/kernel/include
	${CHIBIOS_CONFIG_LOCATION}
	${CHIBIOS_PLATFORM_INCLUDES}
	PARENT_SCOPE)

set (SOURCES ${SOURCES}
	${CMAKE_CURRENT_SOURCE_DIR}/messaging.c
	${CMAKE_CURRENT_SOURCE_DIR}/platform.c
	${CMAKE_CURRENT_SOURCE_DIR}/telemetry_allocator.c
    PARENT_SCOPE)

set (HEADERS ${HEADERS}
    PARENT_SCOPE)
